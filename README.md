# Assignment Quer Project 2

Group # 27 
Students: Giovanni Tangredi s276086 , Francesco Xia s276509

## Suggested action for compiling and executing the project

execute the following commands:
```bat
make
./bin/main graph_file n query_file [-l] [-q]

OPTIONS
	graph_file    = relative or absolute path
	n                  = number of intervals
	query_file    = relative or absolute path
	-l                 = print generated labels to <add filepath>
	-q                = print generated query results to <add filepath>
```
The executable is saved as bin/main
for the tests:
```bat
make test_node
./bin/test
```
The executable is saved as bin/test
Other rules available: test_label, test_graph, test_query, test_bitmap

## Folder Stucture
``` bash
SDPProjectQ2
├── README.md
├── bin
│   ├── main
│   └── test
├── include
│   ├── bitmap.h
│   ├── constants.h
│   ├── graph.h
│   ├── label.h
│   └── query.h
├── makefile
├── src
│   ├── bitmap.c
│   ├── graph.c
│   ├── label.c
│   ├── main.c
│   └── query.c
└── test
    ├── bitmap_test.c
    ├── graph_test.c
    ├── input 
    │   ├── grafo20.gra
    │   ├── grafo20.png
    │   ├── grafo20_25.que
    │   ├── grafo_con_rango.png
    │   └── large
    │       ├── arXiv_sub_6000-1.gra
    │       ├── cit-Patents.scc.gra
    ├── label_test.c
    ├── node_test.c
    ├── output
    │   └── query_output.txt
    └── query_test.c
```
The src folder contains the source files of the project.

The include folder contains the header files. 
Note that there is an additional file called *constant.h* which allows to customize some settings. Those are:
* DEBUG: if set, it prints additional info to stdout
* TEST: must be turned on for running the test cases, otherwise it will fail to compile
* MAX_THREADS_GRAPH: number of running threads used during the graph generation phase
* MAX_THREADS_QUERY: number of running threads used to solve the queries
* ALL_NODES: macro needed in case you want to print the entire graph using graph_print_to_stdout
* MAX_QUERIES: maximum number of queries allowed

The test folder contains the test's source files. 
A sample of a *graph* plus *query* can be found at test/input
The default prints of labels and queries results are saved under are test/output, if not specified otherwise.
The tests were created using the Check.h Framework.

## Program output
If the option -q is passed, the program will create a queries_output.txt file that has for each line:
**source_id destination_id {0/1}** unreachable/reachable
This structure is compatible with the output generated by the original implementation of GRAIL.
Similarly in case the option -l is passed to the program.
The output file has the following format:
**node_id: [l1_l, l1_r] [l2_l] [l2_r]** ...

## Data Stuctures 
The graph is represented using a data structure similar to an Adjacency list. A vector of Node pointers serves as the base for the graph. Each node can be indexed, through the graph struct, using its node_id. Furthermore, for each node we save the list of outgoing edges as a set of node indeces (see Node.children).

## Adopted strategies
The intervals are generated in parallels by running simultaneously n threads, where n is num_intervals passed to the program. 
The child vector of each node is the traverse sequentially starting from a random generated index. In this way in the worst case scenario we complexity is reduced from O(label_generation_time*D) to O(max(label-generation_time)).

For the query a similar strategy is used, the queries are divided in 4 equal blocks one for each thread TODO
